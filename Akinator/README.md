# Акинатор

[Описание проекта](#описание-проекта "Описание проекта")

[База данных](#база-данных "База данных")

[Хранение базы данных](#хранение-базы-данных "Хранение базы данных")

[Функционал](#функционал "Функционал")

[Поиск объекта](#поиск-объекта "Поиск объекта")

[Пример поиска объекта](#пример-поиска-объекта "Пример поиска объекта")

[Дополнительная информация](#дополнительная-информация "Дополнительная информация")

## Описание проекта

Основной целью данного проекта является создание интеллектуальной системы, способной работать с *базой данных*, хранящей иерархически укомплектованные объекты и информацию о них.

## База данных

База данных, которая может быть обработана программой, имеет вид [двоичного дерева](https://ru.wikipedia.org/wiki/%D0%94%D0%B2%D0%BE%D0%B8%D1%87%D0%BD%D0%BE%D0%B5_%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%BE "Двоичное дерево"). Каждый узел такого дерева содержит информацию о некотором свойстве (его текстовое описание), а каждый лист - информацию об объекте (его название). Любой узел имеет ровно два дочерних узла, один из которых для определенности назовем *"правым"*, а другой, соответственно, *"левым"*. При этом должно выполняется следующее правило: для всех объектов, содержащихся в поддереве, корневым узлом которого является *правый* дочерний узел некоторого узла, условие, содержащиеся в родителе корневого элемента этого поддерева, **должно** выполняться. При этом для всех объектов, содержащихся в поддереве, корневым узлом которого является *левый* дочерний узел некоторого узла, условие, содержащиеся в родителе корневого элемента этого поддерева, **не должно** выполняться.

Для удобства работы с базой данных и визуализации содержащийся в ней информации, ее можно графически представить в виде ориентированного графа. Например, логическую структуру базы данных, хранящую названия материков Земли и некоторые их свойства, можно изобразить следующим образом:

![demo.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/demo.png)

На этом рисунке узлы дерева изображены как прямоугольники с надписями (свойствами), листья - как эллипсы с названиями объектов (в данном случае названиями материков), а связи дочернего узла и его родителя как стрелочки. Стрелочки зеленого цвета ведут от родителя к *правому* сыну, а стрелочки красного цвета - от родителя к *левому* сыну. В дальнейшем мы будем неоднократно использовать  подобное представление баз данных с аналогичными обозначениями. 
## Хранение базы данных
Поскольку одна и та же база данных может быть востребована во время различных сеансов работы с программой, необходимо иметь возможность сохранять ее в памяти компьютера. Данная опция реализована в виде записи данных из базы в текстовый файл, с последующей возможностью считать из него данные и возобновить работу с базой.
Текстовая запись базы данных имеет чёткую структуру, определяющуюся следующими правилами:

- Вся запись представляет из себя последовательность строк, содержимое каждой из которых подходит под один из следующих пунктов :
  * Символ начала блока `{` 
  * Символ конца блока `}`
  *  Произвольная строка, первым и последним символом которой являются `"`

- В первой строке внутри двойных кавычек `"` записано значение корневого узла, то есть текст содержащегося в нем свойства.
- После каждого записанного свойства следует описание двух подряд идущих блоков. В первом блоке описывается поддерево, корневым элементом которого является *правый* сын узла с данным свойством, а во втором описывается поддерево, корневым элементом которого является *левый* сын узла с данным свойством.
- Если *правым* или *левым* сыном некоторого узла является не узел, а лист, то значения листа (название объекта) записывается в соответствующий блок, после чего данный блок закрывается.
- Каждый блок начинается с символа открытия `{` и заканчивается символом закрытия `}`, между которыми должно быть не менее 1 строки. 

В качестве примера файла, информация в котором записана по этим правилам, мы возьмем небольшую базу данных, содержащую 2 свойства и 3 объекта:

![file.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/file.png)

В текстовом формате эта база данных будет выглядеть следующим образом:
```
"Холодное"
{
"Мороженое"
}
{
"Шоколадное"
{
"Конфета"
}
{
"Вафля"
}
}
```
## Функционал

При помощи данной программы пользователь может выполнять следующие действия:

- Нахождение "определения" объекта, то есть получение одним за одним свойств всех узлов, соединяющих данный объект и корневой узел дерева.
- Нахождение "сравнения" двух объектов, то есть получение одним за одним свойств всех узлов, соединяющих данные объекты и корневой узел дерева, с указанием какие узлы являются общими для обоих объектов, а какие нет.
- Нахождения объекта через вводимые пользователем данные о его свойствах, путем обхода дерева начиная с корневого узла. Алгоритм обхода подробно описан ниже.

Помимо этого имеются инструменты для непосредственной работы с базой данных и ее редактирования, доступные для разработчика:
- Добавление новых объектов и их свойств в базу.
- Генерация изображения, визуализирующего содержимое базы, при помощи [DOT](https://ru.wikipedia.org/wiki/DOT_(%D1%8F%D0%B7%D1%8B%D0%BA)).

## Поиск объекта

Поиск объекта по свойствам - это процесс частичного обхода дерева, конечной целью которого является нахождение объекта через задание некоторых заранее известных его свойств. Для одного конкретного узла данный процесс можно описать следующим алгоритмом:

1. На экран выводится свойство, записанное в данном узле. Оно печатается в форме вопроса, на который пользователь должен дать ответ. *Вводимые пользователем данные* должны дать информацию о том, является ли этой свойство верным для искомого объекта, или нет.
2. В зависимости от *введенных пользователем данных* данных производится одно из действий, описанных ниже.
3. Если дочерний элемент данного узла, на который был совершен переход, оказался не узлом, а листом, то рекурсивный проход по дереву приостанавливается и на экран выводится название объекта из данного листа. Пользователю задается вопрос, является ли этот объект тем, который он загадывал, и в зависимости от *ответа пользователя*  программа либо завершает свою работу (если нужный объект был найден), либо продолжает обход.

Под ответами пользователя подразумеваются вводимые им данные в консоль. В качестве ответа на каждый заданный пользователю вопрос о свойстве объекта (который задается в пункте 2 алгоритма) принимается целое число от -2 до 2 включительно, каждое из которых интерпретируется как одно из следующих логических значений:  
- 2 – Уверенный положительный ответ. Происходит переход на *правый* дочерний элемент.
- 1 – Неуверенный положительный ответ. Происходит переход на *правый* дочерний элемент. Указатель на *левый* дочерний элемент помещается в *стек неуверенных узлов*.
- 0 – Неуверенный ответ (обрабатывается программой аналогично неуверенному положительному ответу)  
- -1 – Неуверенный отрицательный ответ. Происходит переход на *левый* дочерний элемент. Указатель на *правый* дочерний элемент помещается в *стек неуверенных узлов*. 
- -2 – Уверенный отрицательный ответ. Происходит переход на *левый* дочерний элемент.  

В качестве ответа на представленный пользователю вопрос об объекте (который задается в пункте 3 алгоритма) воспринимаются 0 или 1: 
- 1 – Предоставленный объект был загадан пользователем. Программа  завершается.  
- 0 – Предоставленный объект не был загадан пользователем. Если *стек неуверенных узлов* пуст, программа завершает свою работу; если же нет, происходит переход по указателю из *стека* на узел, а сам указатель из *стека* удаляется.  

Проход всегда осуществляется начиная с корневого узла дерева.
Наличие возможности давать неуверенные ответы позволяет пользователю находить объекты даже в тех случаях, когда он не уверен, обладает ли объект теми или иными свойствами.

## Пример поиска объекта

Далее будет рассмотрен пример поиска объекта, в ходе которого пользователь некоторые ответы давал неуверенно. В данном кейсе в качестве базы данных будут выступать направления подготовки [Физтех-школы ФПМИ](https://mipt.ru/education/departments/fpmi/ "Физтех-школа ФПМИ"), а в качестве пользователя абитуриент Саша, который запутался в них и хочет найти по косвенным признакам нужную.

![begin.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/begin.png)

Предположим, Саша хочет поступить на ИВТ (он еще не знает, что нужное ему направление называется именно так), поскольку ему интересно программирование, в том числе на низкоуровневых языках. Будем рассматривать его взаимодействие с программой поэтапно, подробно расписывая каждый шаг. Фиолетовым цветом будут отмечены элементы на графе, которые обрабатываются в данной итерации, а синим те, указатели на которые находятся в *стеке неуверенных узлов*. В правом нижнем углу будет показано состояние стека.

### Итерация 1

![i1.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i1.png)

Итак, поскольку обход дерева начинается с корневого узла, первым вопросом, который видит Саша, является `На этом направлении изучается экономика?`. Экономика его не интересует, и он, разумеется, вводит `-2`, сообщая этим самым программе, что на интересующем его направлении экономики нет. Происходит переход на левый дочерний узел.

### Итерация 2

![i2.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i2.png)

Вопрос `На этом направлении изучается физика?` вызывает у Саши некоторые сомнения. С одной стороны, он хочет поступить на направление связанное в первую очередь с программированием, но с другой вполне возможно, что и физика на нем тоже есть. Он не знает что выбрать, поэтому отвечает `0`. Программа переходит на правый дочерний узел, допуская, что это свойство было верным, но при этом в стек помещается указатель на левый дочерний узел, на случай если Саша ошибся.

### Итерация 3

![i3.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i3.png)

Теперь спрашивается `На этом направлении физики больше чем программирования?`, но и в ответе на этот вопрос Саша не до конца уверен. Конечно, на интересующем его направлении программирования скорее всего должно быть наоборот больше, но чтобы лишний раз не ошибиться, он отвечает `-1`. Программа переходит на левый дочерний узел, допуская, что это свойство было неверным, но при этом в стек помещается указатель на правый дочерний узел, на случай если Саша и в этот раз ошибся.

### Итерация 4

![i4.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i4.png)

Программа дошла до листа, а это значит, что какой-то объект был найден. Осталось понять, его ли искал Саша или нет. Когда на вопрос `Вы загадывали КТ?` он ответил `0`, стало понятно, что нет. К счастью, на этот момент в стеке лежали два указателя на другие узлы, а значит обход можно было продолжать. Программа перешла на узел по указателю и удалила его из стека, чтобы в будущем снова по нему не перейти.

### Итерация 5

![i5.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i5.png)

Увидев, что на ПМФ еще больше физики и еще меньше программирования, чем на КТ, на вопрос `Вы загадывали ПМФ?` он снова ответил вводом `0`. Однако в стеке все еще лежал один указатель на узел, по которому программа перешла дальше, после чего удалила его из стека.

### Итерация 6

![i6.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i6.png)

На вопрос `На этом направлении изучается низкоуровневое программирование?` Саша однозначно отвечает да, введя `2`, ведь это именно то, что он хочет. Происходит переход на правый дочерний узел.

### Итерация 7

![i7.png](https://github.com/Allexande/PhystechTasks/blob/master/Akinator/Pics/i7.png)

Наконец программа доходит до листа `ИВТ`. Изучив информацию о данном направлении, он понял, что это именно то, что ему нужно, и на вопрос `Вы загадывали ИВТ?` Саша дает положительный ответ `1`. Таким образом, нужный объект был найден даже не смотря на то, что Саша несколько раз не знал что ответить и даже давал ошибочные ответы. Программа завершает свою работу.

## Дополнительная информация

Проект создан в 2020 году

Автор: Тузман Александр Михайлович

[Профиль ВКонтакте](https://vk.com/id479958357 "Профиль ВКонтакте")
